!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).GoodsAttr=e()}(this,(function(){"use strict";function t(t){return t.replace(/^\s+|\s+$/g,"")}function e(e,i){if(i&&t(i)){var s=t(i).split(/\s+/),o=t(e.className);e.className=o?o.split(/\s+/).concat(s).join(" "):s.join(" ")}}function i(e,i){if(t(e.className)&&i&&t(i)&&s(e,i)){i=t(i);for(var o=t(e.className).split(/\s+/),r=0,l=[];r<o.length;)o[r]!==i&&l.push(o[r]),++r;e.className=l.join(" ")}}function s(e,i){if(i&&t(i))return t(e.className).split(/\s+/).indexOf(t(i))>=0}"function"!=typeof NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);return class{constructor(t,e={}){t&&(this.el=t,this.opt=function(t={},e={}){for(let i in e)t[i]=e[i];return t}({matchList:[],matchAttr:"primeId",rowCls:"row",itemCls:"item",itemActiveCls:"active",itemPrimeAttr:"data-p",success:null,fail:null},e),this.opt.matchList.length&&(this.rows=this.el.querySelectorAll("."+this.opt.rowCls),this.rows&&(this.formatPrimeList(),this.createModel(),this.init())))}init(){this.initState(),this.bindEvent()}bindEvent(){function t(t){const s=t.rowIndex,o=this.model[s];for(let t=0;t<o.length;t++)i(o[t],"active");i(t,"disabled"),e(t,"active"),o.active=t,o.activePrime=t.prime}this.el.addEventListener("click",(e=>{if(e.preventDefault(),e.target.matches("."+this.opt.itemCls)){const i=e.target;if(s(i,"active"))return;t.call(this,i),this.otherRowHandle(+i.prime,i.rowIndex,!0)}}),!1)}formatPrimeList(){const t={},e=[];this.opt.matchList.forEach((i=>{const s=i[this.opt.matchAttr];t[s]=i,e.push(+s)})),this.primeObj=t,this.primeList=e}rowModel(t){const e={},i=this.rows[t],s=i.querySelector("."+this.opt.itemActiveCls),o=i.querySelectorAll("."+this.opt.itemCls);o.forEach(((i,o)=>{i.rowIndex=t,i.prime=+i.getAttribute(this.opt.itemPrimeAttr),e[o]=i,i===s&&(e.active=i,e.activePrime=i.prime)})),e.length=o.length,this.model[t]=e}createModel(){this.model=[],this.rows.forEach(((t,e)=>{this.rowModel(e)}))}initState(){this.model.forEach(((t,e)=>{const i=+t.activePrime;this.otherRowHandle(i,e)}))}otherRowHandle(t,s,o){const r=this.primeList.filter((e=>{if(e%t==0)return e/t}));this.model.forEach(((t,l)=>{if(l!==s)for(let s=0;s<t.length;s++){const l=t[s],c=l.prime;let n=!1;for(let t=0;t<r.length;t++){r[t]%c==0&&(n=!0)}o&&!n&&i(l,"active"),n?i(l,"disabled"):e(l,"disabled")}})),this.callback()}callback(){let t=1;this.model.forEach(((e,i)=>{t*=+e.activePrime})),t in this.primeObj?"function"==typeof this.opt.success&&this.opt.success.call(this,this.primeObj[t]):"function"==typeof this.opt.fail&&this.opt.fail.call(this)}}}));
